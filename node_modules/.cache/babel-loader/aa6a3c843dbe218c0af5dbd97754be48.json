{"ast":null,"code":"import { call, put, takeEvery } from \"redux-saga/effects\"; // Login Redux States\n\nimport { GET_SUPER_ADMIN_API, GET_USER_DETAILS_AFTER_LOGIN, LOGIN_USER, LOGOUT_USER, ROLE_ACCESS_API_CALL } from \"./actionTypes\";\nimport { apiError, divisionDropdownSelectSuccess, getUserDetailsAction, getUserDetailsActionSuccess, loginSuccess, logoutUserSuccess, postSuperAdminSuccess, RoleAccessUpdateSuccess, roleAceessAction, roleAceessActionSuccess } from \"./actions\";\nimport { getFirebaseBackend } from \"../../../helpers/firebase_helper\";\nimport { divisionDropdown_Forlogin_ChangeDivisionPage_ApiCall, getUserDetails_afterLogin_ApiCall, post_SuperAdmin, Python_FoodERP_postJwtLogin, RoleAccessApi_url, showPagesListOnPageAccess_DropDown_List, UserPartiesForUserMaster_API } from \"../../../helpers/backend_helper\";\nimport { AlertState } from \"../../actions\";\nconst fireBaseBackend = getFirebaseBackend();\n\nfunction* loginUser(_ref) {\n  let {\n    payload: {\n      user,\n      history\n    }\n  } = _ref;\n\n  try {\n    const response = yield call(Python_FoodERP_postJwtLogin, {\n      LoginName: user.UserName,\n      password: user.Password\n    });\n\n    try {\n      if (response.StatusCode === 200) {\n        localStorage.setItem(\"token\", response.token);\n        localStorage.setItem(\"userId\", response.UserID);\n        history.push(\"/division\");\n      } else {\n        yield put(apiError(\"Incorrect UserName And Password\"));\n      }\n    } catch (e) {\n      yield put(apiError(\"Incorrect UserName And Password\"));\n    }\n  } catch (error) {\n    yield put(apiError(\"Incorrect UserName And Password\"));\n  }\n}\n\nfunction* afterLoginUserDetails_genFun(_ref2) {\n  let {\n    id\n  } = _ref2;\n\n  try {\n    const response = yield call(getUserDetails_afterLogin_ApiCall, {\n      UserId: id\n    });\n    yield put(getUserDetailsActionSuccess(response.Data));\n    localStorage.setItem(\"UserName\", response.Data.UserName);\n    var employee = response.Data.EmployeeID;\n    const response2 = yield call(divisionDropdown_Forlogin_ChangeDivisionPage_ApiCall, employee);\n    yield put(divisionDropdownSelectSuccess(response2.Data));\n  } catch (e) {}\n}\n\nfunction* logoutUser(_ref3) {\n  let {\n    payload: {\n      history\n    }\n  } = _ref3;\n\n  try {\n    localStorage.removeItem(\"authUser\");\n\n    if (process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\n      const response = yield call(fireBaseBackend.logout);\n      yield put(logoutUserSuccess(response));\n    }\n\n    history.push(\"/login\");\n  } catch (error) {\n    yield put(apiError(error));\n  }\n}\n\nfunction* RoleAccessGenratorFunction(_ref4) {\n  let {\n    id1,\n    id2\n  } = _ref4;\n\n  try {\n    const PageAccessApi = yield call(showPagesListOnPageAccess_DropDown_List);\n    const RoleResponse = yield call(RoleAccessApi_url, id1, id2);\n\n    if (RoleResponse.Data.length > 0 && PageAccessApi.Data.length > 0) {\n      let arrayMain = [];\n      let objMain = {};\n      let arrayChild = [];\n      let objChild = {};\n      let all_DataInSinlgeArray = [];\n      RoleResponse.Data.forEach(parent => {\n        objMain = parent;\n        parent.ModuleData.forEach(child => {\n          objChild = child;\n          PageAccessApi.Data.forEach(page => {\n            objChild[`RoleAccess_${page.Name}`] = false;\n          });\n          child.RolePageAccess.forEach(role => {\n            child[`RoleAccess_${role.Name}`] = true;\n          });\n          arrayChild.push(objChild);\n          delete objMain.ModuleData;\n          objMain[\"ModuleData\"] = arrayChild;\n          objChild = {};\n        });\n        arrayMain.push(objMain);\n        arrayChild = [];\n        objMain = {};\n      });\n      arrayMain.forEach(i => {\n        i.ModuleData.forEach(index => {\n          all_DataInSinlgeArray.push(index);\n        });\n      });\n      yield put(roleAceessActionSuccess(arrayMain));\n      yield put(RoleAccessUpdateSuccess(all_DataInSinlgeArray));\n    }\n  } catch (error) {\n    yield put(hasError500());\n    yield put(AlertState({\n      Type: 4,\n      Status: true,\n      Message: \"500 Error RoleAccess Api\"\n    }));\n  }\n}\n\n_c = RoleAccessGenratorFunction;\n\nfunction* Post_SuperAdmin_API_GenratorFunction() {\n  // yield put(SpinnerState(true))\n  try {\n    const response = yield call(post_SuperAdmin);\n    yield put(postSuperAdminSuccess(response.Data)); // yield put(SpinnerState(false))\n  } catch (error) {\n    // / yield put(SpinnerState(false))\n    yield put(AlertState({\n      Type: 4,\n      Status: true,\n      Message: \"500 Error Message\"\n    }));\n  }\n}\n\n_c2 = Post_SuperAdmin_API_GenratorFunction;\n\nfunction* authSaga() {\n  yield takeEvery(LOGIN_USER, loginUser);\n  yield takeEvery(GET_USER_DETAILS_AFTER_LOGIN, afterLoginUserDetails_genFun);\n  yield takeEvery(ROLE_ACCESS_API_CALL, RoleAccessGenratorFunction);\n  yield takeEvery(LOGOUT_USER, logoutUser);\n  yield takeEvery(GET_SUPER_ADMIN_API, Post_SuperAdmin_API_GenratorFunction);\n}\n\nexport default authSaga;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"RoleAccessGenratorFunction\");\n$RefreshReg$(_c2, \"Post_SuperAdmin_API_GenratorFunction\");","map":{"version":3,"names":["call","put","takeEvery","GET_SUPER_ADMIN_API","GET_USER_DETAILS_AFTER_LOGIN","LOGIN_USER","LOGOUT_USER","ROLE_ACCESS_API_CALL","apiError","divisionDropdownSelectSuccess","getUserDetailsAction","getUserDetailsActionSuccess","loginSuccess","logoutUserSuccess","postSuperAdminSuccess","RoleAccessUpdateSuccess","roleAceessAction","roleAceessActionSuccess","getFirebaseBackend","divisionDropdown_Forlogin_ChangeDivisionPage_ApiCall","getUserDetails_afterLogin_ApiCall","post_SuperAdmin","Python_FoodERP_postJwtLogin","RoleAccessApi_url","showPagesListOnPageAccess_DropDown_List","UserPartiesForUserMaster_API","AlertState","fireBaseBackend","loginUser","payload","user","history","response","LoginName","UserName","password","Password","StatusCode","localStorage","setItem","token","UserID","push","e","error","afterLoginUserDetails_genFun","id","UserId","Data","employee","EmployeeID","response2","logoutUser","removeItem","process","env","REACT_APP_DEFAULTAUTH","logout","RoleAccessGenratorFunction","id1","id2","PageAccessApi","RoleResponse","length","arrayMain","objMain","arrayChild","objChild","all_DataInSinlgeArray","forEach","parent","ModuleData","child","page","Name","RolePageAccess","role","i","index","hasError500","Type","Status","Message","Post_SuperAdmin_API_GenratorFunction","authSaga"],"sources":["D:/GitProjects/Manthan/src/store/auth/login/saga.js"],"sourcesContent":["import { call, put, takeEvery } from \"redux-saga/effects\"\r\n\r\n// Login Redux States\r\nimport {\r\n  GET_SUPER_ADMIN_API,\r\n  GET_USER_DETAILS_AFTER_LOGIN,\r\n  LOGIN_USER, LOGOUT_USER,\r\n  ROLE_ACCESS_API_CALL\r\n} from \"./actionTypes\"\r\nimport {\r\n  apiError, divisionDropdownSelectSuccess, getUserDetailsAction, getUserDetailsActionSuccess, loginSuccess,\r\n  logoutUserSuccess,\r\n  postSuperAdminSuccess,\r\n  RoleAccessUpdateSuccess,\r\n  roleAceessAction,\r\n  roleAceessActionSuccess\r\n} from \"./actions\"\r\n\r\nimport { getFirebaseBackend } from \"../../../helpers/firebase_helper\"\r\nimport {\r\n  divisionDropdown_Forlogin_ChangeDivisionPage_ApiCall,\r\n  getUserDetails_afterLogin_ApiCall,\r\n  post_SuperAdmin,\r\n  Python_FoodERP_postJwtLogin, RoleAccessApi_url, showPagesListOnPageAccess_DropDown_List, UserPartiesForUserMaster_API\r\n} from \"../../../helpers/backend_helper\"\r\nimport { AlertState } from \"../../actions\"\r\n\r\nconst fireBaseBackend = getFirebaseBackend()\r\n\r\nfunction* loginUser({ payload: { user, history } }) {\r\n\r\n  try {\r\n    const response =\r\n      yield call(Python_FoodERP_postJwtLogin, {\r\n        LoginName: user.UserName,\r\n        password: user.Password\r\n      })\r\n    try {\r\n      if (response.StatusCode === 200) {\r\n\r\n        localStorage.setItem(\"token\", (response.token))\r\n        localStorage.setItem(\"userId\", (response.UserID))\r\n\r\n        history.push(\"/division\")\r\n      }\r\n      else {\r\n        yield put(apiError(\"Incorrect UserName And Password\"))\r\n      }\r\n\r\n    } catch (e) {\r\n      yield put(apiError(\"Incorrect UserName And Password\"))\r\n    }\r\n\r\n  } catch (error) {\r\n    yield put(apiError(\"Incorrect UserName And Password\"))\r\n  }\r\n}\r\nfunction* afterLoginUserDetails_genFun({ id }) {\r\n\r\n  try {\r\n\r\n    const response = yield call(getUserDetails_afterLogin_ApiCall, {\r\n      UserId: id,\r\n    })\r\n    yield put(getUserDetailsActionSuccess(response.Data))\r\n    localStorage.setItem(\"UserName\", (response.Data.UserName))\r\n\r\n    var employee = response.Data.EmployeeID;\r\n\r\n    const response2 = yield call(divisionDropdown_Forlogin_ChangeDivisionPage_ApiCall, employee,)\r\n    yield put(divisionDropdownSelectSuccess(response2.Data))\r\n\r\n  } catch (e) {\r\n\r\n  }\r\n}\r\n\r\nfunction* logoutUser({ payload: { history } }) {\r\n  try {\r\n    localStorage.removeItem(\"authUser\")\r\n\r\n    if (process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\r\n      const response = yield call(fireBaseBackend.logout)\r\n      yield put(logoutUserSuccess(response))\r\n    }\r\n    history.push(\"/login\")\r\n  } catch (error) {\r\n    yield put(apiError(error))\r\n  }\r\n}\r\nfunction* RoleAccessGenratorFunction({ id1, id2, }) {\r\n\r\n  try {\r\n    const PageAccessApi = yield call(showPagesListOnPageAccess_DropDown_List)\r\n\r\n    const RoleResponse = yield call(RoleAccessApi_url, id1, id2,);\r\n\r\n    if ((RoleResponse.Data.length > 0) && (PageAccessApi.Data.length > 0)) {\r\n\r\n      let arrayMain = []\r\n      let objMain = {}\r\n      let arrayChild = []\r\n      let objChild = {}\r\n      let all_DataInSinlgeArray = []\r\n\r\n      RoleResponse.Data.forEach((parent) => {\r\n        objMain = parent;\r\n\r\n        parent.ModuleData.forEach((child) => {\r\n\r\n          objChild = child;\r\n\r\n          PageAccessApi.Data.forEach((page) => {\r\n            objChild[`RoleAccess_${page.Name}`] = false;\r\n          })\r\n\r\n          child.RolePageAccess.forEach((role) => {\r\n            child[`RoleAccess_${role.Name}`] = true;\r\n          })\r\n\r\n          arrayChild.push(objChild)\r\n          delete objMain.ModuleData\r\n          objMain[\"ModuleData\"] = arrayChild\r\n          objChild = {};\r\n\r\n        });\r\n        arrayMain.push(objMain)\r\n        arrayChild = []\r\n        objMain = {}\r\n      })\r\n\r\n      arrayMain.forEach((i) => {\r\n        i.ModuleData.forEach((index) => {\r\n          all_DataInSinlgeArray.push(index)\r\n        })\r\n      })\r\n\r\n\r\n      yield put(roleAceessActionSuccess(arrayMain))\r\n      yield put(RoleAccessUpdateSuccess(all_DataInSinlgeArray))\r\n    }\r\n\r\n  } catch (error) {\r\n    yield put(hasError500())\r\n    yield put(AlertState({\r\n      Type: 4,\r\n      Status: true, Message: \"500 Error RoleAccess Api\",\r\n    }));\r\n  }\r\n}\r\n\r\nfunction* Post_SuperAdmin_API_GenratorFunction() {\r\n  // yield put(SpinnerState(true))\r\n  try {\r\n    const response = yield call(post_SuperAdmin);\r\n    yield put(postSuperAdminSuccess(response.Data));\r\n    // yield put(SpinnerState(false))\r\n  } catch (error) {\r\n    // / yield put(SpinnerState(false))\r\n    yield put(AlertState({\r\n      Type: 4,\r\n      Status: true, Message: \"500 Error Message\",\r\n    }));\r\n  }\r\n}\r\nfunction* authSaga() {\r\n  yield takeEvery(LOGIN_USER, loginUser)\r\n  yield takeEvery(GET_USER_DETAILS_AFTER_LOGIN, afterLoginUserDetails_genFun)\r\n  yield takeEvery(ROLE_ACCESS_API_CALL, RoleAccessGenratorFunction)\r\n  yield takeEvery(LOGOUT_USER, logoutUser)\r\n  yield takeEvery(GET_SUPER_ADMIN_API, Post_SuperAdmin_API_GenratorFunction)\r\n}\r\n\r\nexport default authSaga\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}