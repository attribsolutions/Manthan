{"ast":null,"code":"import _classCallCheck from\"D:/GitProjects/Manthan/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/GitProjects/Manthan/node_modules/@babel/runtime/helpers/esm/createClass\";import firebase from\"firebase/app\";// Add the Firebase products that you want to use\nimport\"firebase/auth\";import\"firebase/firestore\";var FirebaseAuthBackend=/*#__PURE__*/function(){function FirebaseAuthBackend(firebaseConfig){var _this=this;_classCallCheck(this,FirebaseAuthBackend);this.registerUser=function(email,password){return new Promise(function(resolve,reject){firebase.auth().createUserWithEmailAndPassword(email,password).then(function(user){resolve(firebase.auth().currentUser);},function(error){reject(_this._handleError(error));});});};this.editProfileAPI=function(email,password){return new Promise(function(resolve,reject){firebase.auth().createUserWithEmailAndPassword(email,password).then(function(user){resolve(firebase.auth().currentUser);},function(error){reject(_this._handleError(error));});});};this.loginUser=function(email,password){return new Promise(function(resolve,reject){firebase.auth().signInWithEmailAndPassword(email,password).then(function(user){resolve(firebase.auth().currentUser);},function(error){reject(_this._handleError(error));});});};this.forgetPassword=function(email){return new Promise(function(resolve,reject){firebase.auth().sendPasswordResetEmail(email,{url:window.location.protocol+\"//\"+window.location.host+\"/login\"}).then(function(){resolve(true);}).catch(function(error){reject(_this._handleError(error));});});};this.logout=function(){return new Promise(function(resolve,reject){firebase.auth().signOut().then(function(){resolve(true);}).catch(function(error){reject(_this._handleError(error));});});};this.socialLoginUser=function(data,type){var credential={};if(type===\"google\"){credential=firebase.auth.GoogleAuthProvider.credential(data.idToken,data.token);}else if(type===\"facebook\"){credential=firebase.auth.FacebookAuthProvider.credential(data.token);}return new Promise(function(resolve,reject){if(!!credential){firebase.auth().signInWithCredential(credential).then(function(user){resolve(_this.addNewUserToFirestore(user));}).catch(function(error){reject(_this._handleError(error));});}});};this.addNewUserToFirestore=function(user){var collection=firebase.firestore().collection(\"users\");var profile=user.additionalUserInfo.profile;var details={firstName:profile.given_name?profile.given_name:profile.first_name,lastName:profile.family_name?profile.family_name:profile.last_name,fullName:profile.name,email:profile.email,picture:profile.picture,createdDtm:firebase.firestore.FieldValue.serverTimestamp(),lastLoginTime:firebase.firestore.FieldValue.serverTimestamp()};collection.doc(firebase.auth().currentUser.uid).set(details);return{user:user,details:details};};this.setLoggeedInUser=function(user){localStorage.setItem(\"authUser\",JSON.stringify(user));};this.getAuthenticatedUser=function(){if(!localStorage.getItem(\"authUser\"))return null;return JSON.parse(localStorage.getItem(\"authUser\"));};if(firebaseConfig){// Initialize Firebase\nfirebase.initializeApp(firebaseConfig);firebase.auth().onAuthStateChanged(function(user){if(user){localStorage.setItem(\"authUser\",JSON.stringify(user));}else{localStorage.removeItem(\"authUser\");}});}}/**\r\n   * Registers the user with given details\r\n   */_createClass(FirebaseAuthBackend,[{key:\"_handleError\",value:/**\r\n   * Handle the error\r\n   * @param {*} error\r\n   */function _handleError(error){// var errorCode = error.code;\nvar errorMessage=error.message;return errorMessage;}}]);return FirebaseAuthBackend;}();var _fireBaseBackend=null;/**\r\n * Initilize the backend\r\n * @param {*} config\r\n */var initFirebaseBackend=function initFirebaseBackend(config){if(!_fireBaseBackend){_fireBaseBackend=new FirebaseAuthBackend(config);}return _fireBaseBackend;};/**\r\n * Returns the firebase backend\r\n */var getFirebaseBackend=function getFirebaseBackend(){return _fireBaseBackend;};export{initFirebaseBackend,getFirebaseBackend};","map":{"version":3,"names":["firebase","FirebaseAuthBackend","firebaseConfig","registerUser","email","password","Promise","resolve","reject","auth","createUserWithEmailAndPassword","then","user","currentUser","error","_handleError","editProfileAPI","loginUser","signInWithEmailAndPassword","forgetPassword","sendPasswordResetEmail","url","window","location","protocol","host","catch","logout","signOut","socialLoginUser","data","type","credential","GoogleAuthProvider","idToken","token","FacebookAuthProvider","signInWithCredential","addNewUserToFirestore","collection","firestore","profile","additionalUserInfo","details","firstName","given_name","first_name","lastName","family_name","last_name","fullName","name","picture","createdDtm","FieldValue","serverTimestamp","lastLoginTime","doc","uid","set","setLoggeedInUser","localStorage","setItem","JSON","stringify","getAuthenticatedUser","getItem","parse","initializeApp","onAuthStateChanged","removeItem","errorMessage","message","_fireBaseBackend","initFirebaseBackend","config","getFirebaseBackend"],"sources":["D:/GitProjects/Manthan/src/helpers/firebase_helper.js"],"sourcesContent":["import firebase from \"firebase/app\"\r\n\r\n// Add the Firebase products that you want to use\r\nimport \"firebase/auth\"\r\nimport \"firebase/firestore\"\r\n\r\nclass FirebaseAuthBackend {\r\n  \r\n  constructor(firebaseConfig) {\r\n    if (firebaseConfig) {\r\n      // Initialize Firebase\r\n      firebase.initializeApp(firebaseConfig)\r\n      firebase.auth().onAuthStateChanged(user => {\r\n        if (user) {\r\n          localStorage.setItem(\"authUser\", JSON.stringify(user))\r\n        } else {\r\n          localStorage.removeItem(\"authUser\")\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Registers the user with given details\r\n   */\r\n\r\n  registerUser = (email, password) => {\r\n    return new Promise((resolve, reject) => {\r\n      firebase\r\n        .auth()\r\n        .createUserWithEmailAndPassword(email, password)\r\n        .then(\r\n          user => {\r\n            resolve(firebase.auth().currentUser)\r\n          },\r\n          error => {\r\n            reject(this._handleError(error))\r\n          }\r\n        )\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Registers the user with given details\r\n   */\r\n\r\n  editProfileAPI = (email, password) => {\r\n    return new Promise((resolve, reject) => {\r\n      firebase\r\n        .auth()\r\n        .createUserWithEmailAndPassword(email, password)\r\n        .then(\r\n          user => {\r\n            resolve(firebase.auth().currentUser)\r\n          },\r\n          error => {\r\n            reject(this._handleError(error))\r\n          }\r\n        )\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Login user with given details\r\n   */\r\n  loginUser = (email, password) => {\r\n    return new Promise((resolve, reject) => {\r\n      firebase\r\n        .auth()\r\n        .signInWithEmailAndPassword(email, password)\r\n        .then(\r\n          user => {\r\n            resolve(firebase.auth().currentUser)\r\n          },\r\n          error => {\r\n            reject(this._handleError(error))\r\n          }\r\n        )\r\n    })\r\n  }\r\n\r\n  /**\r\n   * forget Password user with given details\r\n   */\r\n  forgetPassword = email => {\r\n    return new Promise((resolve, reject) => {\r\n      firebase\r\n        .auth()\r\n        .sendPasswordResetEmail(email, {\r\n          url:\r\n            window.location.protocol + \"//\" + window.location.host + \"/login\",\r\n        })\r\n        .then(() => {\r\n          resolve(true)\r\n        })\r\n        .catch(error => {\r\n          reject(this._handleError(error))\r\n        })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Logout the user\r\n   */\r\n  logout = () => {\r\n    return new Promise((resolve, reject) => {\r\n      firebase\r\n        .auth()\r\n        .signOut()\r\n        .then(() => {\r\n          resolve(true)\r\n        })\r\n        .catch(error => {\r\n          reject(this._handleError(error))\r\n        })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Social Login user with given details\r\n   */\r\n  socialLoginUser = (data, type) => {\r\n    let credential = {}\r\n    if (type === \"google\") {\r\n      credential = firebase.auth.GoogleAuthProvider.credential(data.idToken, data.token)\r\n    } else if (type === \"facebook\") {\r\n      credential = firebase.auth.FacebookAuthProvider.credential(data.token)\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      if (!!credential) {\r\n        firebase.auth().signInWithCredential(credential)\r\n          .then(user => {\r\n            resolve(this.addNewUserToFirestore(user))\r\n          })\r\n          .catch(error => {\r\n            reject(this._handleError(error))\r\n          })\r\n      }\r\n    })\r\n  }\r\n\r\n  addNewUserToFirestore = (user) => {\r\n    const collection = firebase.firestore().collection(\"users\")\r\n    const { profile } = user.additionalUserInfo\r\n    const details = {\r\n      firstName: profile.given_name ? profile.given_name : profile.first_name,\r\n      lastName: profile.family_name ? profile.family_name : profile.last_name,\r\n      fullName: profile.name,\r\n      email: profile.email,\r\n      picture: profile.picture,\r\n      createdDtm: firebase.firestore.FieldValue.serverTimestamp(),\r\n      lastLoginTime: firebase.firestore.FieldValue.serverTimestamp()\r\n    }\r\n    collection.doc(firebase.auth().currentUser.uid).set(details)\r\n    return { user, details }\r\n  }\r\n\r\n  setLoggeedInUser = user => {\r\n    localStorage.setItem(\"authUser\", JSON.stringify(user))\r\n  }\r\n\r\n  /**\r\n   * Returns the authenticated user\r\n   */\r\n  getAuthenticatedUser = () => {\r\n    if (!localStorage.getItem(\"authUser\")) return null\r\n    return JSON.parse(localStorage.getItem(\"authUser\"))\r\n  }\r\n\r\n  /**\r\n   * Handle the error\r\n   * @param {*} error\r\n   */\r\n  _handleError(error) {\r\n    // var errorCode = error.code;\r\n    var errorMessage = error.message\r\n    return errorMessage\r\n  }\r\n}\r\n\r\nlet _fireBaseBackend = null\r\n\r\n/**\r\n * Initilize the backend\r\n * @param {*} config\r\n */\r\nconst initFirebaseBackend = config => {\r\n  if (!_fireBaseBackend) {\r\n    _fireBaseBackend = new FirebaseAuthBackend(config)\r\n  }\r\n  return _fireBaseBackend\r\n}\r\n\r\n/**\r\n * Returns the firebase backend\r\n */\r\nconst getFirebaseBackend = () => {\r\n  return _fireBaseBackend\r\n}\r\n\r\nexport { initFirebaseBackend, getFirebaseBackend }\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}